<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI提示词管理器 - 设置</title>
    <link rel="stylesheet" href="options.css" />
  </head>
  <body>
    <div class="container">
      <div class="content">
        <div id="status" class="status"></div>

        <div class="section">
          <h2 class="section-title">飞书应用配置</h2>

          <div class="info-box">
            <h3>📝 如何获取飞书API配置?</h3>
            <ol>
              <li>
                访问
                <a href="https://open.feishu.cn/app" target="_blank"
                  >飞书开放平台</a
                >
                创建企业自建应用
              </li>
              <li>
                在应用详情页获取 <code>App ID</code> 和 <code>App Secret</code>
                <br /><strong>注意:</strong> App ID 通常以
                <code>cli_</code> 开头
              </li>
              <li>
                在"权限管理"中开通以下权限:
                <ul style="margin-top: 8px; margin-left: 24px">
                  <li><strong>必需权限（读取）:</strong></li>
                  <li>
                    <code>bitable:app:readonly</code> - 只读访问多维表格应用
                  </li>
                  <li><code>bitable:table:readonly</code> - 只读访问表格</li>
                  <li><code>bitable:record:readonly</code> - 只读访问记录</li>
                  <li><strong>必需权限（写入）:</strong></li>
                  <li><code>bitable:app</code> - 访问多维表格应用</li>
                  <li><code>bitable:table</code> - 访问表格</li>
                  <li><code>bitable:record</code> - 访问记录</li>
                  <li><strong>如果多维表格在 Wiki 中，还需要:</strong></li>
                  <li><code>wiki:wiki:readonly</code> - 只读访问 Wiki</li>
                  <li><code>wiki:node:retrieve</code> - 获取 Wiki 节点信息</li>
                </ul>
              </li>
              <li>
                从飞书多维表格链接中获取表格ID: <br />例如链接:
                <code
                  >https://lcn3039ispf9.feishu.cn/wiki/CXiMwgOnBiSe9Gkdd6XcHcl9nld?table=tblVwAn97O27RmEA&view=vewXoGhv04</code
                >
                <br />表格ID是: <code>tblVwAn97O27RmEA</code> (URL中 table
                参数的值) <br />Wiki节点ID是:
                <code>CXiMwgOnBiSe9Gkdd6XcHcl9nld</code>
                (URL中 wiki/ 后面的部分)
              </li>
            </ol>
          </div>

          <div class="form-group">
            <label for="feishuAppId">App ID *</label>
            <input type="text" id="feishuAppId" placeholder="cli_xxxxxxxxxx" />
            <div class="help-text">在飞书开放平台应用详情页获取</div>
          </div>

          <div class="form-group">
            <label for="feishuAppSecret">App Secret *</label>
            <input
              type="password"
              id="feishuAppSecret"
              placeholder="xxxxxxxxxxxxx"
            />
            <div class="help-text">在飞书开放平台应用详情页获取,请妥善保管</div>
          </div>

          <div class="form-group">
            <label for="feishuSheetId">表格 ID (Table ID) *</label>
            <input
              type="text"
              id="feishuSheetId"
              placeholder="tblVwAn97O27RmEA"
            />
            <div class="help-text">
              从飞书多维表格URL中获取，通常以 tbl 开头<br />
              <strong>例如:</strong> tblVwAn97O27RmEA (从您的链接中获取)
            </div>
          </div>

          <div class="form-group">
            <label for="feishuWikiNodeId">Wiki 节点 ID (可选)</label>
            <input
              type="text"
              id="feishuWikiNodeId"
              placeholder="CXiMwgOnBiSe9Gkdd6XcHcl9nld"
            />
            <div class="help-text">
              如果多维表格在飞书知识库(Wiki)中，请填写Wiki节点ID<br />
              <strong>例如:</strong> CXiMwgOnBiSe9Gkdd6XcHcl9nld
              (从您的链接中获取)<br />
              <strong>注意:</strong> 仅当多维表格在Wiki中时需要填写
            </div>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">同步设置</h2>

          <div class="info-box">
            <h3>ℹ️ 同步说明</h3>
            <p>• 插件会自动每24小时同步一次数据到飞书多维表格</p>
            <p>• 也可以在弹出窗口手动触发同步</p>
            <p>• 本地数据保存在Chrome localStorage中</p>
            <p>
              • 表格数据格式: 提示词ID | 提示词 | 中文解释 | 备注 | 分类ID |
              分类名称 | 提示词库ID | 提示词
            </p>
          </div>

          <div class="form-group">
            <label>上次同步时间</label>
            <input
              type="text"
              id="lastSyncTime"
              readonly
              placeholder="暂未同步"
            />
          </div>

          <div class="form-group">
            <label>同步状态</label>
            <input
              type="text"
              id="lastSyncStatus"
              readonly
              placeholder="暂未同步"
            />
          </div>
        </div>

        <div class="actions">
          <button class="btn btn-secondary" id="testConnection">
            测试连接
          </button>
          <button class="btn btn-primary" id="saveSettings">保存设置</button>
        </div>
      </div>
    </div>

    <script src="options.js"></script>
  </body>
</html>
